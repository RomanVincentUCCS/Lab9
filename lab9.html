<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Japan Birth Rate Chart</title>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dimple/2.3.0/dimple.latest.min.js"></script>
  <style>
    #chartContainer {
      width: 840px;
      margin: auto;
      margin-top: 50px;
    }
    #charttitle {
      font: bold 22px Verdana, sans-serif;
      margin-left: 60px;
    }
    #chartsubhead {
      margin-left: 60px;
      font-family: Verdana, sans-serif;
    }
  </style>
</head>
<body>
  <div id="chartContainer">
    <p id="charttitle">Japan Birth Rates</p>
    <p id="chartsubhead">The Decline (2007–2022)</p>
    <svg id="chartSVG" width="840" height="440"></svg>
  </div>

  <script>
    // Create the SVG for the chart
    var svg = dimple.newSvg("#chartSVG", 840, 440);

    d3.csv("https://raw.githubusercontent.com/RomanVincentUCCS/Lab9/main/japan_birth.csv", function(data) {
      console.log("Raw data:", data);

      // Convert values to appropriate types
      data.forEach(function(d) {
        d.year = +d.year;
        d.birth_rate = +d.birth_rate;
      });

      // Filter years 2007–2022
      var filtered = data.filter(function(d) {
        return d.year >= 2007 && d.year <= 2022;
      });

      // Convert year to string for axis
      filtered.forEach(function(d) {
        d.year = d.year.toString();
      });

      console.log("Filtered data:", filtered);

      // Build the chart
      var chart = new dimple.chart(svg, filtered);
      chart.setBounds(60, 30, 700, 300);

      var x = chart.addCategoryAxis("x", "year");
      x.addOrderRule("year");

      var y = chart.addMeasureAxis("y", "birth_rate");
      y.overrideMin = 6;
      y.overrideMax = 9;
      y.title = "Births per 1,000 People";

      var series = chart.addSeries(null, dimple.plot.line);
      series.lineWeight = 3;
      series.lineMarkers = true;

      chart.draw();
    });
  </script>
</body>
</html>


